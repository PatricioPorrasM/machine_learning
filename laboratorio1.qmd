---
title: "Laboratorio 1"
author: "Patricio Porras"
date: "2025-09-27"
format: 
    html: 
        embed-resources: true
echo: false
---

# Laboratorio 1

## Carga de datos

```{python}
import pandas as pd
import altair as alt
```

```{python}
data_df = pd.read_csv("mdi_homicidios_intencionales_pm_2014_2024.csv")
```

```{python}
data_df.head()
```

```{python}
data_df.describe()
```


```{python}
data_df.info()
```


```{python}
# Reemplaza "sin dato" por NaN
data_df["edad"] = data_df["edad"].replace("SIN DATO", pd.NA)

# Convierte la columna a numérica (si no lo está)
data_df["edad"] = pd.to_numeric(data_df["edad"], errors="coerce")

# Calcula la media ignorando los nulos
media_edad = data_df["edad"].mean()

# Rellena los nulos con la media
data_df["edad"] = data_df["edad"].fillna(media_edad)

#data_df["codigo_provincia"] = pd.to_numeric(data_df["codigo_provincia"], errors="0")
```

```{python}
data_df["fecha_infraccion_dt"] = pd.to_datetime(data_df["fecha_infraccion"], errors="coerce")
data_df["year"] = data_df["fecha_infraccion_dt"].dt.year
```

```{python}
data_df.info()

```

## Graficas

```{python}
alt.Chart(data_df).mark_point(filled=True, size=80, opacity=0.7).encode(
    x=alt.X("provincia:N", title="Provincia", sort="-y", axis=alt.Axis(labelAngle=-45)),
    y=alt.Y("edad:Q", title="Edad de la víctima"),
    color=alt.Color("arma:N", title="Tipo de arma"),
    shape=alt.Shape("arma:N", title="Tipo de arma"),
    tooltip=["provincia", "edad", "arma", "year"]
).properties(
    title="Edad de las víctimas de homicidio por provincia y tipo de arma",
    width=700,
    height=400
).interactive()
```

## Número de muertes por provincias

```{python}
alt.Chart(data_df).mark_bar().encode(
    x=alt.X('provincia:N', sort='-y', title='Provincia'),
    y=alt.Y('count():Q', title='Total de registros'),
    color=alt.Color('year:N', title='Año'),
    tooltip=['provincia', 'year', 'count()']
).properties(
    title='Total de registros por año y provincia'
)
```


```{python}
alt.Chart(data_df).mark_line(point=True).encode(
    x=alt.X('year:O', title='Año'),
    y=alt.Y('count():Q', title='Total de muertes'),
    color=alt.Color('provincia:N', title='Provincia'),
    tooltip=['provincia', 'year', 'count()']
).properties(
    title='Número de muertes por año y provincia'
)
```